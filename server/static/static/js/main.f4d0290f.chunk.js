(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],[,function(e,t,a){e.exports={"machine-card":"styles_machine-card__1duPV",bottom:"styles_bottom__1U_BQ",details:"styles_details__1Igfz","machine-name":"styles_machine-name__bn44c",footer:"styles_footer__12H9L",box:"styles_box__2nOHi",actions:"styles_actions__1CfTL"}},,,,,,function(e,t,a){e.exports={"terminal-modal-window":"styles_terminal-modal-window__3wdC-",menu:"styles_menu__3y0pB",open:"styles_open__1crG0",title:"styles_title__3MEDx",actions:"styles_actions__20PZp",action:"styles_action__UsJXo",terminal:"styles_terminal__1eTtd"}},,,,function(e,t,a){e.exports={taskbar:"styles_taskbar__23gA5",tabs:"styles_tabs__1LhQJ"}},,function(e,t,a){e.exports={App:"App_App__15LM-"}},function(e,t,a){e.exports=a(20)},,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),l=a(9),i=a.n(l),o=(a(19),a(2)),c=a(3),r=a(5),m=a(4),h=a(6),u=a(13),p=a.n(u),f=a(1),d=a.n(f),y=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(r.a)(this,Object(m.a)(t).call(this,e))).state=a.props.config,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e="",t=this.props.xMin+" "+this.props.yMin+" "+this.props.xMax+" "+this.props.yMax,a=!0,n=!1,l=void 0;try{for(var i,o=this.props.points[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var c=i.value;e+=c.x+","+c.y+" "}}catch(r){n=!0,l=r}finally{try{a||null==o.return||o.return()}finally{if(n)throw l}}return s.a.createElement("svg",{viewBox:t,width:"100%",height:"100%",style:{background:this.props.backgroundColor||"white"}},s.a.createElement("defs",null,s.a.createElement("pattern",{id:"smallGrid",width:"20",height:"20",patternUnits:"userSpaceOnUse"},s.a.createElement("path",{d:"M 20 0 L 0 0 0 20",fill:"none",stroke:this.props.gridColor||"gray",strokeWidth:"0.5"}))),s.a.createElement("rect",{width:"100%",height:"100%",fill:"url(#smallGrid)"}),s.a.createElement("polyline",{fill:"none",stroke:this.props.lineColor||"#0074d9",strokeWidth:"2",points:e}))}}]),t}(s.a.Component),v=a(10),b=(a(8),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(r.a)(this,Object(m.a)(t).call(this,e))).openShell=function(){window.addShell(a.props.config.name)},a.parseSocketMessage=function(e){return new Promise((function(t,a){if(e.data instanceof Blob){var n=new FileReader;n.onload=function(){t(n.result)},n.readAsText(e.data)}else t(e.data)}))},a.state={data:[],memmory:0,cpu:0,shell:!1,shellRef:null,shellVisible:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=new WebSocket("ws://127.0.0.1:8081");t.onmessage=function(t){var a=e.state.data,n=JSON.parse(t.data),s=parseInt(n.cpuUsage);a.push(s),a.length>11&&(a=a.slice(1)),e.setState({data:a,memory:parseFloat(n.memUsage).toFixed(0),cpu:s})},t.onopen=function(){t.send(JSON.stringify({name:e.props.config.name})),t.send(JSON.stringify({service:"monitor"}))}}},{key:"render",value:function(){var e=Object.assign(this.state.data).map((function(e,t){return{x:200-20*(10-t),y:100-e}}));return s.a.createElement("div",{className:d.a["machine-card"]},s.a.createElement("div",{style:{width:"300px",height:"150px"}},s.a.createElement(y,{xMin:0,xMax:201,yMin:0,yMax:101,points:e,horizontalLine:1,verticalLines:1,backgroundColor:"white",gridColor:"green",lineColor:"purple"}),s.a.createElement("br",null)),s.a.createElement("div",{className:d.a.bottom},s.a.createElement("div",{className:d.a.details},s.a.createElement("span",{className:d.a["machine-name"]},s.a.createElement("i",{className:"fas fa-server"})," ",this.props.config.name),s.a.createElement("div",{className:d.a.footer},s.a.createElement("div",{className:d.a["machine-stats"]},s.a.createElement("span",null,s.a.createElement("i",{className:"fas fa-desktop"})," ",this.state.cpu,"%"),s.a.createElement("span",null,s.a.createElement("i",{className:"fas fa-microchip"})," ",this.state.memory,"%")))),s.a.createElement("div",{className:d.a.actions},s.a.createElement("span",{onClick:this.openShell,className:d.a.box},s.a.createElement("i",{className:"fas fa-scroll"})),s.a.createElement("span",{onClick:this.openShell,className:d.a.box},s.a.createElement("i",{className:"fas fa-terminal"})))),this.state.shell&&s.a.createElement("div",{className:d.a["terminal-modal"],style:{display:this.state.shellVisible?"block":"none"}},s.a.createElement("div",{className:d.a["terminal-modal-window"]},s.a.createElement("span",{onClick:this.closeShell,className:d.a.close},s.a.createElement("i",{className:"fas fa-times"})),s.a.createElement("div",{ref:this.state.shellRef}))))}}]),t}(s.a.Component)),_=a(11),E=a.n(_),k=a(7),w=a.n(k),g=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(r.a)(this,Object(m.a)(t).call(this,e))).minimize=function(){a.setState({open:!a.state.open})},a.parseSocketMessage=function(e){return new Promise((function(t,a){if(e.data instanceof Blob){var n=new FileReader;n.onload=function(){t(n.result)},n.readAsText(e.data)}else t(e.data)}))},a.state={name:a.props.name,shellRef:a.props.shellRef,open:!0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this;this.setState({shellVisible:!0},(function(){var a=new v.Terminal;a.open(e.state.shellRef.current);var n=new WebSocket("ws://127.0.0.1:8081");n.onmessage=function(e){t.parseSocketMessage(e).then((function(e){a.write(e)}))},n.onopen=function(){n.send(JSON.stringify({name:t.props.name})),n.send(JSON.stringify({service:"shell"})),a.onKey((function(e){n.send(e.key)}))}}))}},{key:"render",value:function(){return s.a.createElement("div",{className:w.a["terminal-modal-window"]},s.a.createElement("div",{className:w.a.menu+" "+(this.state.open?w.a.open:"")},s.a.createElement("div",{className:w.a.title},this.state.name),s.a.createElement("div",{className:w.a.actions},s.a.createElement("span",{onClick:this.minimize,className:w.a.action},s.a.createElement("i",{className:"fas fa-minus"})),s.a.createElement("span",{onClick:this.props.closeShell,className:w.a.action},s.a.createElement("i",{className:"fas fa-times"})))),s.a.createElement("div",{style:{display:this.state.open?"block":"none"},className:w.a.terminal,ref:this.state.shellRef}))}}]),t}(s.a.Component),N=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(r.a)(this,Object(m.a)(t).call(this,e))).closeShell=function(e){return function(){var t=Object.assign(a.state.shells);t=t.filter((function(t){return console.log(t.shellRef,e),t.shellRef!=e})),a.setState({shells:t})}},a.state={shells:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addShell=function(t){var a=Object.assign(e.state.shells);a.push({name:"local",shellRef:s.a.createRef(),key:100*Math.random()}),e.setState({shells:a})}}},{key:"render",value:function(){var e=this,t=this.state.shells.map((function(t){return s.a.createElement(g,{key:t.key,shellRef:t.shellRef,name:t.name,closeShell:e.closeShell(t.shellRef)})}));return s.a.createElement("div",{className:E.a.taskbar},s.a.createElement("div",{className:E.a.tabs},t))}}]),t}(s.a.Component),O=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(r.a)(this,Object(m.a)(t).call(this,e))).state={machines:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("/api/machines").then((function(e){return e.json()})).then((function(t){e.setState({machines:t})}))}},{key:"render",value:function(){var e=this.state.machines.map((function(e,t){return s.a.createElement(b,{config:e,key:t})}));return s.a.createElement("div",{className:p.a.App},e,s.a.createElement(N,null))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(O,null),document.getElementById("root"))}],[[14,1,2]]]);
//# sourceMappingURL=main.f4d0290f.chunk.js.map